............F
ERROR: Coverage failure: total of 60 is less than fail-under=95

=================================== FAILURES ===================================
___________________________ test_protected_endpoints ___________________________

admin_creds = {'code': '945727', 'password': 'CCCCCCCCCCCCCCCC', 'token': 'BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB', 'username': 'admin'}

    def test_protected_endpoints(admin_creds):
        headers = {"Authorization": f"Bearer {admin_creds['token']}"}
        for ep in ["/pnl", "/positions", "/alerts", "/kpis"]:
            resp = client.get(ep, params={"username": admin_creds["username"], "code": admin_creds["code"]}, headers=headers)
>           assert resp.status_code == 200
E           assert 500 == 200
E            +  where 500 = <Response [500 Internal Server Error]>.status_code

tests/core/mac/test_api.py:70: AssertionError
------------------------------ Captured log call -------------------------------
WARNING  mt5_rest_client:mt5_rest_client.py:35 Erreur réseau (tentative 1): ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))
WARNING  mt5_rest_client:mt5_rest_client.py:35 Erreur réseau (tentative 2): ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))
WARNING  mt5_rest_client:mt5_rest_client.py:35 Erreur réseau (tentative 3): ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.11.13-final-0 _______________

Name                                Stmts   Miss  Cover   Missing
-----------------------------------------------------------------
bot/connectors/mt5_rest_client.py      50     20    60%   30-33, 38-41, 45-46, 50-51, 55-65, 69, 73
-----------------------------------------------------------------
TOTAL                                  50     20    60%
FAIL Required test coverage of 95% not reached. Total coverage: 60.00%
=========================== short test summary info ============================
FAILED tests/core/mac/test_api.py::test_protected_endpoints - assert 500 == 200
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
1 failed, 12 passed, 22 warnings in 3.35s
